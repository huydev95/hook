
var Throttler = require('./throttler').Throttler;

class AddressThrottler {
  function initialize(throttler) {
    this.throttler = throttler || new Throttler(10, 60);
  }

  function post(req, res) {
    var key = req.connection.remoteAddress;
    this.throttler.log(key);

    if (! throttler.shouldAllow(key)) {
      res.writeHeader(403, {});
      res.end();
      return false;
    }
  }
}
